[{"path":"https://semiparmf.j3z.dev/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 SemiparMF authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://semiparmf.j3z.dev/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jezzu Morrisen Quimosing. Author, maintainer, copyright holder.","code":""},{"path":"https://semiparmf.j3z.dev/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Quimosing J (2026). SemiparMF: Semiparametric Spatiotemporal Model Mixed Frequencies. R package version 1.0.0, https://github.com/jzeuzs/SemiparMF.","code":"@Manual{,   title = {SemiparMF: Semiparametric Spatiotemporal Model with Mixed Frequencies},   author = {Jezzu Morrisen Quimosing},   year = {2026},   note = {R package version 1.0.0},   url = {https://github.com/jzeuzs/SemiparMF}, }"},{"path":"https://semiparmf.j3z.dev/index.html","id":"semiparmf","dir":"","previous_headings":"","what":"Semiparametric Spatiotemporal Model with Mixed Frequencies","title":"Semiparametric Spatiotemporal Model with Mixed Frequencies","text":"SemiparMF implements Semiparametric Spatiotemporal Model Mixed Frequencies. designed scenarios response variable (e.g., quarterly crop yield) observed lower frequency key non-parametric predictor (e.g., monthly rainfall NDVI), also accounting parametric covariates spatial/temporal autocorrelation. methodology based paper: Malabanan, V. ., Lansangan, J. R. G., & Barrios, E. B. (2022). Semiparametric Spatiotemporal Model Mixed Frequencies: Application Crop Forecasting. Science & Engineering Journal, 15(2), 90-107. https://scienggj.org/2022/SciEnggJ%202022-vol15-no02-p90-107-Malabanan%20et%20al.pdf","code":""},{"path":"https://semiparmf.j3z.dev/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Semiparametric Spatiotemporal Model with Mixed Frequencies","text":"can install development version SemiparMF like :","code":"# install.packages(\"devtools\") devtools::install_github(\"jzeuzs/SemiparMF\")"},{"path":"https://semiparmf.j3z.dev/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Semiparametric Spatiotemporal Model with Mixed Frequencies","text":"example demonstrates simulate data fit model using package’s built-tools. can also inspect convergence backfitting algorithm plotting Mean Squared Prediction Error (MSPE) iterations.  Furthermore, can predict response new data. Note prediction aggregates high-frequency non-parametric component adds parametric linear combination.","code":"library(SemiparMF) library(sf) #> Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE  # 1. Generate synthetic data # We simulate a 6x6 grid (36 locations) over 50 time points. # The frequency ratio is 3 (e.g., months per quarter). set.seed(123) sim_data <- simulate_semipar_data(n_side = 6, t_len = 50, k = 3, rho_error = 0.5)  # Inspect the data structure head(sim_data$data) #> Simple feature collection with 6 features and 5 fields #> Geometry type: POLYGON #> Dimension:     XY #> Bounding box:  xmin: 0 ymin: 0 xmax: 1 ymax: 1 #> CRS:           NA #>   location_id time_id        Y         Z  W                       geometry #> 1           1       1 57.58180  79.93880 55 POLYGON ((0 0, 1 0, 1 1, 0 ... #> 2           1       2 78.72706 116.03521 59 POLYGON ((0 0, 1 0, 1 1, 0 ... #> 3           1       3 65.18883 100.25659 48 POLYGON ((0 0, 1 0, 1 1, 0 ... #> 4           1       4 66.99771  97.89679 54 POLYGON ((0 0, 1 0, 1 1, 0 ... #> 5           1       5 70.53500 103.54290 49 POLYGON ((0 0, 1 0, 1 1, 0 ... #> 6           1       6 59.84531  89.27175 46 POLYGON ((0 0, 1 0, 1 1, 0 ...  # 2. Fit the Semiparametric Model # Formula: Response ~ Parametric_Covariate # We specify the time and ID columns for the panel structure. fit <- semiparMF(   formula = Y ~ Z,   data_sf = sim_data$data,   high_freq_data = sim_data$X_high,   time_col = \"time_id\",   id_col = \"location_id\" ) #> Calculating spatial weights (Queen Contiguity)...  # 3. View Results summary(fit) #>  #> -- Model Summary -- #> Call: #> semiparMF(formula = Y ~ Z, data_sf = sim_data$data, high_freq_data = sim_data$X_high,  #>     time_col = \"time_id\", id_col = \"location_id\") #>  #> Coefficients: #>   Beta (Parametric):    0.49641  #>   Gamma (Spatial):      -0.00108  #>   Rho (Temporal):       0.06947  #>  #> Residuals: #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -7.9549668 -1.6033471 -0.0490949  0.0002055  1.5875291  8.5325065  #>  #> Convergence: #>   Iterations:  6  #>   Final MSPE:  5.999642 plot(fit) # Predict on the training data for demonstration preds <- predict(   fit,    new_high_freq = sim_data$X_high,    new_z = matrix(sim_data$data$Z, nrow = 36, byrow = TRUE),   new_w = matrix(sim_data$data$W, nrow = 36, byrow = TRUE) )  # Compare first 5 predictions to actuals head(as.vector(preds), 5) #> [1] 57.46916 67.41472 59.56201 68.31180 63.98256 head(sim_data$data$Y, 5) #> [1] 57.58180 78.72706 65.18883 66.99771 70.53500"},{"path":"https://semiparmf.j3z.dev/reference/dot-semipar_internal.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal Computational Function for SemiparMF — .semipar_internal","title":"Internal Computational Function for SemiparMF — .semipar_internal","text":"Implements iterative backfitting algorithm Cochrane-Orcutt updates described Malabanan et al. (2022). function handles core estimation loop, separating non-parametric spline component parametric temporal components.","code":""},{"path":"https://semiparmf.j3z.dev/reference/dot-semipar_internal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal Computational Function for SemiparMF — .semipar_internal","text":"","code":".semipar_internal(y, x_high, z_low, w_mat, max_iter = 50, tol = 1e-04, ...)"},{"path":"https://semiparmf.j3z.dev/reference/dot-semipar_internal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal Computational Function for SemiparMF — .semipar_internal","text":"y Numeric matrix (N x T). response variable wide format (rows=locations, cols=time). x_high Numeric array (N x T x K). high-frequency covariate. N: Number spatial locations. T: Number low-frequency time points (matching y). K: Frequency ratio (e.g., 3 monthly data predicting quarterly response). z_low Numeric matrix (N x T). parametric covariate (frequency y). w_mat Numeric matrix (N x T). spatial neighborhood covariate (e.g., spatial lag Z). max_iter Integer. Maximum number backfitting iterations. Default 50. tol Numeric. Convergence tolerance based percentage change Mean Squared Prediction Error (MSPE). Default 1e-4. ... Additional arguments passed smooth.spline (e.g., spar).","code":""},{"path":"https://semiparmf.j3z.dev/reference/dot-semipar_internal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal Computational Function for SemiparMF — .semipar_internal","text":"list containing: coefficients List scalar estimates: beta (covariate effect), gamma (spatial effect), rho (temporal autocorrelation). nonparam List containing spline object f_hat (estimated non-parametric component). residuals Matrix (N x T) pure structural residuals \\((Y - \\hat{Y})\\). fitted.values Matrix (N x T) fitted values. history Vector MSPE values per iteration. iters Number iterations performed.","code":""},{"path":"https://semiparmf.j3z.dev/reference/dot-semipar_internal.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Internal Computational Function for SemiparMF — .semipar_internal","text":"Malabanan, V. ., Lansangan, J. R. G., & Barrios, E. B. (2022). Semiparametric Spatiotemporal Model Mixed Frequencies: Application Crop Forecasting. Science & Engineering Journal, 15(2), 90-107.","code":""},{"path":"https://semiparmf.j3z.dev/reference/plot.semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Convergence History — plot.semiparMF","title":"Plot Convergence History — plot.semiparMF","text":"Plots Mean Squared Prediction Error (MSPE) across iterations.","code":""},{"path":"https://semiparmf.j3z.dev/reference/plot.semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Convergence History — plot.semiparMF","text":"","code":"# S3 method for class 'semiparMF' plot(x, ...)"},{"path":"https://semiparmf.j3z.dev/reference/plot.semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Convergence History — plot.semiparMF","text":"x object class semiparMF. ... Additional graphical parameters.","code":""},{"path":"https://semiparmf.j3z.dev/reference/plot.semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Convergence History — plot.semiparMF","text":"return value, called side effects (plotting).","code":""},{"path":"https://semiparmf.j3z.dev/reference/predict.semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Method for SemiparMF — predict.semiparMF","title":"Predict Method for SemiparMF — predict.semiparMF","text":"Generates predictions new data. Reference: \"Predicted values calculated simply adding scores... linear combination\".","code":""},{"path":"https://semiparmf.j3z.dev/reference/predict.semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Method for SemiparMF — predict.semiparMF","text":"","code":"# S3 method for class 'semiparMF' predict(object, new_high_freq, new_z, new_w, ...)"},{"path":"https://semiparmf.j3z.dev/reference/predict.semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Method for SemiparMF — predict.semiparMF","text":"object object class semiparMF. new_high_freq Numeric array (N x T_new x K) high-frequency covariate. new_z Numeric matrix (N x T_new) parametric covariate. new_w Numeric matrix (N x T_new) neighborhood covariate. ... Additional arguments.","code":""},{"path":"https://semiparmf.j3z.dev/reference/predict.semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Method for SemiparMF — predict.semiparMF","text":"matrix (N x T_new) predicted values.","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Method for SemiparMF — print.semiparMF","title":"Print Method for SemiparMF — print.semiparMF","text":"Print Method SemiparMF","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Method for SemiparMF — print.semiparMF","text":"","code":"# S3 method for class 'semiparMF' print(x, ...)"},{"path":"https://semiparmf.j3z.dev/reference/print.semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Method for SemiparMF — print.semiparMF","text":"x object class semiparMF. ... Additional arguments.","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Method for SemiparMF — print.semiparMF","text":"input object x returned invisibly.","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.summary.semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Summary for SemiparMF — print.summary.semiparMF","title":"Print Summary for SemiparMF — print.summary.semiparMF","text":"Print Summary SemiparMF","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.summary.semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Summary for SemiparMF — print.summary.semiparMF","text":"","code":"# S3 method for class 'summary.semiparMF' print(x, ...)"},{"path":"https://semiparmf.j3z.dev/reference/print.summary.semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Summary for SemiparMF — print.summary.semiparMF","text":"x object class summary.semiparMF. ... Additional arguments.","code":""},{"path":"https://semiparmf.j3z.dev/reference/print.summary.semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Summary for SemiparMF — print.summary.semiparMF","text":"input object x returned invisibly.","code":""},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"Fits spatiotemporal model response variable observed lower frequency (e.g., quarterly) non-parametric covariate (e.g., monthly). model combines non-parametric component high-frequency predictor, parametric components low-frequency predictors spatial neighborhood effects, autoregressive error structure.","code":""},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"","code":"semiparMF(   formula,   data_sf,   high_freq_data,   time_col,   id_col,   w_matrix = NULL,   ... )"},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"formula formula object (e.g., Y ~ Z). left-hand side response variable (low frequency). first predictor right-hand side parametric covariate ($Z$) measured frequency. data_sf sf object containing panel data long format. Must contain columns response, parametric covariate, time index, location ID. high_freq_data numeric array dimensions (N x T x K), : N: Number unique spatial locations (must match data_sf). T: Number time points (must match data_sf). K: frequency ratio (e.g., 3 predictor monthly response quarterly). time_col Character string. name column data_sf representing time index. id_col Character string. name column data_sf representing location ID. w_matrix Optional numeric matrix (N x T). pre-calculated spatial weight neighborhood variable. NULL (default), spatial lag variable $Z$ calculated using Queen Contiguity weights. ... Additional arguments passed internal backfitting function (e.g., max_iter, tol, spar).","code":""},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"object class semiparMF containing: coefficients list estimated parameters: beta (parametric covariate effect), gamma (neighborhood effect), rho (autoregressive parameter). nonparam list containing fitted smoothing spline aggregated non-parametric component f_hat. residuals Matrix (N x T) model residuals. fitted.values Matrix (N x T) fitted values (structural part ). dims Dimensions data (N, T). meta Metadata containing location IDs time indices. history Convergence history (MSPE per iteration). call function call.","code":""},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"Malabanan, V. ., Lansangan, J. R. G., & Barrios, E. B. (2022). Semiparametric Spatiotemporal Model Mixed Frequencies: Application Crop Forecasting. Science & Engineering Journal, 15(2), 90-107.","code":""},{"path":"https://semiparmf.j3z.dev/reference/semiparMF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit Semiparametric Spatiotemporal Model with Mixed Frequencies — semiparMF","text":"","code":"# Simulate data using the package's included simulation function sim <- simulate_semipar_data(n_side = 4, t_len = 20, k = 3, rho_error = 0.5)  # Fit the model fit <- semiparMF(   formula = Y ~ Z,    data_sf = sim$data,    high_freq_data = sim$X_high,   time_col = \"time_id\",    id_col = \"location_id\" ) #> Calculating spatial weights (Queen Contiguity)...  # Inspect results summary(fit) #>  #> -- Model Summary -- #> Call: #> semiparMF(formula = Y ~ Z, data_sf = sim$data, high_freq_data = sim$X_high,  #>     time_col = \"time_id\", id_col = \"location_id\") #>  #> Coefficients: #>   Beta (Parametric):    0.4805  #>   Gamma (Spatial):      -0.02814  #>   Rho (Temporal):       0.01043  #>  #> Residuals: #>       Min.    1st Qu.     Median       Mean    3rd Qu.       Max.  #> -6.9374035 -1.6515231 -0.1171669  0.0000537  1.5207869 10.1848119  #>  #> Convergence: #>   Iterations:  5  #>   Final MSPE:  6.249991"},{"path":"https://semiparmf.j3z.dev/reference/simulate_semipar_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","title":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","text":"Generates synthetic dataset testing SemiparMF model. Structure follows Equation (7) Malabanan et al. (2022).","code":""},{"path":"https://semiparmf.j3z.dev/reference/simulate_semipar_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","text":"","code":"simulate_semipar_data(   n_side = 6,   t_len = 50,   k = 3,   rho_error = 0.5,   beta = 0.5,   gamma = 0.3 )"},{"path":"https://semiparmf.j3z.dev/reference/simulate_semipar_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","text":"n_side Integer. Grid side length. Total locations N = n_side^2. t_len Integer. Length time series (T). k Integer. Frequency ratio (e.g., 3 months per quarter). rho_error Numeric. Autocorrelation coefficient error term (default 0.5). beta True coefficient covariate Z (default 0.5). gamma True coefficient neighborhood variable W (default 0.3).","code":""},{"path":"https://semiparmf.j3z.dev/reference/simulate_semipar_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","text":"list containing: data sf object containing Y, Z, W, geometry. X_high array (N x T x K) high-frequency covariates. true_params List true parameters used generation.","code":""},{"path":"https://semiparmf.j3z.dev/reference/simulate_semipar_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Spatiotemporal Mixed Frequency Data — simulate_semipar_data","text":"","code":"# Generate a small dataset sim <- simulate_semipar_data(n_side = 4, t_len = 10, k = 3)  # Check dimensions dim(sim$data) # 160 x 5 (16 locations * 10 time points) #> [1] 160   6 dim(sim$X_high) # 16 x 10 x 3 #> [1] 16 10  3"},{"path":"https://semiparmf.j3z.dev/reference/summary.semiparMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary Method for SemiparMF — summary.semiparMF","title":"Summary Method for SemiparMF — summary.semiparMF","text":"Summary Method SemiparMF","code":""},{"path":"https://semiparmf.j3z.dev/reference/summary.semiparMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary Method for SemiparMF — summary.semiparMF","text":"","code":"# S3 method for class 'semiparMF' summary(object, ...)"},{"path":"https://semiparmf.j3z.dev/reference/summary.semiparMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary Method for SemiparMF — summary.semiparMF","text":"object object class semiparMF. ... Additional arguments.","code":""},{"path":"https://semiparmf.j3z.dev/reference/summary.semiparMF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary Method for SemiparMF — summary.semiparMF","text":"list class summary.semiparMF containing: coefficients list estimated parameters (beta, gamma, rho). last_mspe Mean Squared Prediction Error final iteration. residuals_summary Summary statistics residuals. iterations Total number iterations performed. call function call.","code":""},{"path":"https://semiparmf.j3z.dev/news/index.html","id":"semiparmf-100","dir":"Changelog","previous_headings":"","what":"SemiparMF 1.0.0","title":"SemiparMF 1.0.0","text":"Initial CRAN submission.","code":""}]
